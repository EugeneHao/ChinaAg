geom_point(aes(x = factor(year), y = pct_corn)) +
facet_wrap(~region)+
theme_classic() +
xlab("Year")+
ylab("% Change in Corn Share Per Year")+
scale_fill_manual(
values = c("TRUE" = "green", "FALSE" = "red"),
labels = c("Negative", "Positive"),
name = NULL
)
#rice
ggplot(data = share_change) +
geom_line(aes(x = factor(year), y = pct_rice), color = "blue", group = 1) +
geom_col(aes(x = factor(year), y = pct_rice, fill = pct_rice > 0))+
geom_point(aes(x = factor(year), y = pct_rice)) +
facet_wrap(~region)+
theme_classic() +
xlab("Year")+
ylab("% Change in Rice Share Per Year")+
scale_fill_manual(
values = c("TRUE" = "green", "FALSE" = "red"),
labels = c("Negative", "Positive"),
name = NULL
)
#wheat
ggplot(data = share_change) +
geom_line(aes(x = factor(year), y = pct_wheat), color = "blue", group = 1) +
geom_col(aes(x = factor(year), y = pct_wheat, fill = pct_wheat > 0))+
geom_point(aes(x = factor(year), y = pct_wheat)) +
facet_wrap(~region)+
theme_classic() +
xlab("Year")+
ylab("% Change in Wheat Share Per Year")+
scale_fill_manual(
values = c("TRUE" = "green", "FALSE" = "red"),
labels = c("Negative", "Positive"),
name = NULL
)
#vege
ggplot(data = share_change) +
geom_line(aes(x = factor(year), y = pct_vege), color = "blue", group = 1) +
geom_col(aes(x = factor(year), y = pct_vege, fill = pct_vege > 0))+
geom_point(aes(x = factor(year), y = pct_vege)) +
facet_wrap(~region)+
theme_classic() +
xlab("Year")+
ylab("% Change in Vegetable Share Per Year")+
scale_fill_manual(
values = c("TRUE" = "green", "FALSE" = "red"),
labels = c("Negative", "Positive"),
name = NULL
)
#fruit
ggplot(data = share_change) +
geom_line(aes(x = factor(year), y = pct_fruit), color = "blue", group = 1) +
geom_col(aes(x = factor(year), y = pct_fruit, fill = pct_fruit > 0))+
geom_point(aes(x = factor(year), y = pct_fruit)) +
facet_wrap(~region)+
theme_classic() +
xlab("Year")+
ylab("% Change in Fruit Share Per Year")+
scale_fill_manual(
values = c("TRUE" = "green", "FALSE" = "red"),
labels = c("Negative", "Positive"),
name = NULL
)
#spatial effects
ggplot(data = acre, aes(x = year, y = share_soy,)) +
geom_point()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region == "Nation"), aes(x = factor(year))) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"), group = 1)+
geom_point(aes(y = share_corn))+
geom_point(aes(y = share_rice))+
geom_point(aes(y = share_wheat))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre %>% filter(region == "Nation"), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_point(aes(y = share_wheat, color = "wheat"))+
geom_point(aes(y = share_vege, color = "vege"))+
geom_point(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre %>% filter(region == "Nation"), aes(x = factor(year) )) +
geom_point(aes(y = share_corn, color = "corn"), group = 1)+
geom_point(aes(y = share_soy, color = "soy"), group = 1)+
geom_point(aes(y = share_rice, color = "rice"), group = 1)+
geom_point(aes(y = share_wheat, color = "wheat"))+
geom_point(aes(y = share_vege, color = "vege"))+
geom_point(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre , aes(x = factor(year) )) +
geom_point(aes(y = share_corn, color = "corn"), group = 1)+
geom_point(aes(y = share_soy, color = "soy"), group = 1)+
geom_point(aes(y = share_rice, color = "rice"), group = 1)+
geom_point(aes(y = share_wheat, color = "wheat"))+
geom_point(aes(y = share_vege, color = "vege"))+
geom_point(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre , aes(x = factor(year) )) +
geom_point(aes(y = share_corn, color = "corn"), group = 1)+
geom_point(aes(y = share_soy, color = "soy"), group = 1)+
geom_point(aes(y = share_rice, color = "rice"), group = 1)+
geom_point(aes(y = share_wheat, color = "wheat"))+
geom_point(aes(y = share_vege, color = "vege"))+
geom_point(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year) )) +
geom_point(aes(y = share_corn, color = "corn"), group = 1)+
geom_point(aes(y = share_soy, color = "soy"), group = 1)+
geom_point(aes(y = share_rice, color = "rice"), group = 1)+
geom_point(aes(y = share_wheat, color = "wheat"))+
geom_point(aes(y = share_vege, color = "vege"))+
geom_point(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"))+
geom_line(aes(y = share_vege, color = "vege"))+
geom_line(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"))+
geom_line(aes(y = share_vege, color = "vege"))+
geom_line(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"))+
geom_line(aes(y = share_vege, color = "vege"))+
geom_line(aes(y = share_fruit, color = "fruit"))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "yellow"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soy"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
acre %>% filter(region == "Anhui")
acre %>% filter(region == "Anhui") %>% view()
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "sown acre in total"), group = 1) +
geom_line(aes(y = share_rice, color = "rice"), group = 1) +
xlab("Year")
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "sown acre in total"), group = 1) +
geom_line(aes(y = share_rice, color = "rice"), group = 1) +
xlab("Year")+
theme_bw()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "sown acre in total"), group = 1) +
geom_line(aes(y = share_rice, color = "rice"), group = 1) +
xlab("Year")+
theme_classic()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "sown acre in total"), group = 1)+
xlab("Year")+
theme_classic()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "sown acre in total"), group = 1)+
xlab("Year")+
ylab("sown acre in total")
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "sown acre in total"), group = 1)+
xlab("Year")+
ylab("sown acre in total")+
theme_classic()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "crop sown acre in total"), group = 1)+
xlab("Year")+
ylab("sown acre in total")+
theme_classic()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "blue"), group = 1)+
xlab("Year")+
ylab(" Crop sown acre in total")+
theme_classic()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total, color = "blue"), group = 1)+
xlab("Year")+
ylab(" Crop sown acre in total")+
theme_classic()
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total), group = 1)+
xlab("Year")+
ylab(" Crop sown acre in total")+
theme_classic()
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn", shape = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn", linetype = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn", linetype = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn", linetype = "solid"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn", linetype = "dashed"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)+
scale_color_manual(values = c("corn" = "red",
"soybean" = "blue",
"rice" = "green",
"wheat" = "purple",
"vege" = "orange",
"fruit" = "brown"))
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)+
scale_color_manual(values = c("corn" = "red",
"soybean" = "blue",
"rice" = "green",
"wheat" = "grey",
"vege" = "orange",
"fruit" = "yellow"))
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)+
scale_color_manual(values = c("corn" = "red",
"soybean" = "blue",
"rice" = "green",
"wheat" = "pink",
"vege" = "orange",
"fruit" = "black"))
ggplot(data = acre %>% filter(region %in% c("Anhui", "Liaoning") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)+
scale_color_manual(values = c("corn" = "red",
"soybean" = "blue",
"rice" = "green",
"wheat" = "purple",
"vege" = "orange",
"fruit" = "black"))
ggplot(data = acre %>% filter(region == "Anhui"), aes(x = factor(year)))+
geom_line(aes(y = acre_total), group = 1)+
xlab("Year")+
ylab(" Crop sown acre in Anhui")+
theme_classic()
ggplot(data = acre %>% filter(region == "Liaoning"), aes(x = factor(year)))+
geom_line(aes(y = acre_total), group = 1)+
xlab("Year")+
ylab(" Crop sown acre in Liaoning")+
theme_classic()
ggplot(data = acre %>% filter(region == "Liaoning"), aes(x = factor(year)))+
geom_line(aes(y = acre_total), group = 1)+
xlab("Year")+
ylab(" Crop sown acre in Liaoning")+
theme_classic()
ggplot(data = acre %>% filter(region == c("Liaoning", "Anhui")), aes(x = factor(year)))+
geom_line(aes(y = acre_total), group = 1)+
xlab("Year")+
ylab("Crop sown acre in total")+
theme_classic()+
facet_wrap(~"region")
ggplot(data = acre %>% filter(region == c("Liaoning", "Anhui")), aes(x = factor(year)))+
geom_line(aes(y = acre_total), group = 1)+
xlab("Year")+
ylab("Crop sown acre in total")+
theme_classic()+
facet_wrap(~region)
acre %>% filter(region == "Heilongjiang")
acre %>% filter(year %in% c(2017, 2018)) select(c(acre_corn,share_corn))
acre %>% filter(year %in% c(2017, 2018)) %>% select(c(acre_corn,share_corn))
acre %>% filter(year %in% c(2017, 2018)) %>% select(c(region,acre_corn,share_corn)) %>% view()
acre %>% filter(year %in% c(2017, 2018)) %>% select(c(region,year,acre_corn,share_corn)) %>% view()
acre %>% filter(year %in% c(2017, 2018)) %>% select(c(region,year,acre_corn,share_corn, crop_weight)) %>% view()
ggplot(data = acre %>% filter(region == "Heilongjiang"), aes(x = factor(year))) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"), group = 1)+
geom_point(aes(y = share_corn))+
geom_point(aes(y = share_rice))+
geom_point(aes(y = share_wheat))+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()
ggplot(data = acre %>% filter(region %in% c("Heilongjiang") ), aes(x = factor(year) )) +
geom_line(aes(y = share_corn, color = "corn"), group = 1)+
geom_line(aes(y = share_soy, color = "soybean"), group = 1)+
geom_line(aes(y = share_rice, color = "rice"), group = 1)+
geom_line(aes(y = share_wheat, color = "wheat"),  group = 1)+
geom_line(aes(y = share_vege, color = "vege"),  group = 1)+
geom_line(aes(y = share_fruit, color = "fruit"),  group = 1)+
xlab("Year") +
ylab("Acreage Share")+
theme_bw()+
facet_wrap(~region)+
scale_color_manual(values = c("corn" = "red",
"soybean" = "blue",
"rice" = "green",
"wheat" = "purple",
"vege" = "orange",
"fruit" = "black"))
#change detection
acre %>% filter(year %in% c(2015, 2016)) %>%
group_by(region) %>% arrange(year) %>%
summarize(soybean = (last(acre_soy)/first(acre_soy)-1)*100,
corn = (last(acre_corn)/first(acre_corn)-1)*100,
rice = (last(acre_rice)/first(acre_rice)-1)*100,
wheat = (last(acre_wheat)/first(acre_wheat)-1)*100,
vege = (last(acre_vege)/first(acre_vege)-1)*100,
fruit = (last(acre_fruit)/first(acre_fruit)-1)*100,
oil = (last(acre_oil)/first(acre_oil)-1)*100) %>%
arrange(desc(soybean))
#share change
acre %>% filter(year %in% c(2015, 2016)) %>%
group_by(region) %>% arrange(year) %>%
summarize(soybean = (last(share_soy)/first(share_soy)-1)*100,
corn = (last(share_corn)/first(share_corn)-1)*100,
rice = (last(share_rice)/first(share_rice)-1)*100,
wheat = (last(share_wheat)/first(share_wheat)-1)*100,
vege = (last(share_vege)/first(share_vege)-1)*100,
fruit = (last(share_fruit)/first(share_fruit)-1)*100,
oil = (last(share_oil)/first(share_oil)-1)*100) %>%
arrange(desc(soybean))
ggplot(data = main, aes(x = year)) +
geom_point(aes(y = share_soy, color = "soy"))+
geom_point(aes(y = share_corn, color = "corn"))+
geom_point(aes(y = share_vege, color = "vege"))+
facet_wrap(~region)
#share change per year
share_change <- main %>% arrange(region, year) %>%
group_by(region) %>%
mutate(pct_soy = (share_soy/lag(share_soy)-1)*100,
pct_corn = (share_corn/lag(share_corn)-1)*100,
pct_rice = (share_rice/lag(share_rice)-1)*100,
pct_wheat = (share_wheat/lag(share_wheat)-1)*100,
pct_vege = (share_vege/lag(share_vege)-1)*100,
pct_fruit = (share_fruit/lag(share_fruit)-1)*100,
pct_oil = (share_oil/lag(share_oil)-1)*100,
)
#corn
ggplot(data = share_change) +
geom_line(aes(x = factor(year), y = pct_corn), color = "blue", group = 1) +
geom_col(aes(x = factor(year), y = pct_corn, fill = pct_corn > 0))+
geom_point(aes(x = factor(year), y = pct_corn)) +
facet_wrap(~region)+
theme_classic() +
xlab("Year")+
ylab("% Change in Corn Share Per Year")+
scale_fill_manual(
values = c("TRUE" = "green", "FALSE" = "red"),
labels = c("Negative", "Positive"),
name = NULL
)
