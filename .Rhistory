preddat_new03 <- prednew %>%
mutate(profit_ex = yield_lag * (ex_price - cost) + subsidy03_lag) %>%
arrange(region, crop, year)
preddat_newsame <- preddat_newsame %>%
mutate(pfex_corn = preddat_newsame %>% filter(crop == "corn") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_rice = preddat_newsame %>% filter(crop == "rice") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_soy = preddat_newsame %>% filter(crop == "soybean") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_wheat = preddat_newsame %>% filter(crop == "wheat") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
policy = 1
)
preddat_new01 <- preddat_new01%>%
mutate(pfex_corn = preddat_new01 %>% filter(crop == "corn") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_rice = preddat_new01 %>% filter(crop == "rice") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_soy = preddat_new01 %>% filter(crop == "soybean") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_wheat = preddat_new01 %>% filter(crop == "wheat") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
policy = 1
)
preddat_new02 <- preddat_new02 %>%
mutate(pfex_corn = preddat_new02 %>% filter(crop == "corn") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_rice = preddat_new02 %>% filter(crop == "rice") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_soy = preddat_new02 %>% filter(crop == "soybean") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_wheat = preddat_new02 %>% filter(crop == "wheat") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
policy = 1
)
preddat_new03 <- preddat_new03 %>%
mutate(pfex_corn = preddat_new03 %>% filter(crop == "corn") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_rice = preddat_new03 %>% filter(crop == "rice") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_soy = preddat_new03 %>% filter(crop == "soybean") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
pfex_wheat = preddat_new03 %>% filter(crop == "wheat") %>% "$"(profit_ex) %>%
matrix(., nrow = 3) %>% kronecker(rep(1, 4), .) %>% as.vector(),
policy = 1
)
preddat_newsame$Y2 <- 0
preddat_new01$Y2 <- 0
preddat_new02$Y2 <- 0
preddat_new03$Y2 <- 0
for(i in c("corn", "rice", "soybean"))
{
if(i == "corn")
{
lmtmp = lm_corn_pf
} else if(i == "rice")
{
lmtmp = lm_rice_pf
} else if(i == "soybean")
{
lmtmp = lm_soy_pf
}
preddat_newsame$Y2[preddat_newsame$crop == i] <-
predict(lmtmp, newdata = preddat_newsame %>% filter(crop == i))
preddat_new01$Y2[preddat_new01$crop == i] <-
predict(lmtmp, newdata = preddat_new01 %>% filter(crop == i))
preddat_new02$Y2[preddat_new02$crop == i] <-
predict(lmtmp, newdata = preddat_new02 %>% filter(crop == i))
preddat_new03$Y2[preddat_new03$crop == i] <-
predict(lmtmp, newdata = preddat_new03 %>% filter(crop == i))
}
preddat_newsame$share <- 0
preddat_new01$share <- 0
preddat_new02$share <- 0
preddat_new03$share <- 0
for(i in 2022:2024)
{
# fix
tmp_newsame <- preddat_newsame %>% filter(year == i, crop != "wheat") %>%
"$"(Y2) %>%matrix(., ncol = 3, byrow = T)
other_newsame <- 1/(rowSums(exp(tmp_newsame)) + 1)
share_newsame <- sweep(exp(tmp_newsame), MARGIN = 1, FUN = "*", STATS = other_newsame)
preddat_newsame$share[preddat_newsame$year == i &
preddat_newsame$crop != "wheat"] <-
t(share_newsame) %>% as.numeric()
# soybean increase 10%
tmp_new01 <- preddat_new01 %>% filter(year == i, crop != "wheat") %>%
"$"(Y2) %>%matrix(., ncol = 3, byrow = T)
other_new01 <- 1/(rowSums(exp(tmp_new01)) + 1)
share_new01 <- sweep(exp(tmp_new01), MARGIN = 1, FUN = "*", STATS = other_new01)
preddat_new01$share[preddat_new01$year == i &
preddat_new01$crop != "wheat"] <-
t(share_new01) %>% as.numeric()
# soybean increase 20%
tmp_new02 <- preddat_new02 %>% filter(year == i, crop != "wheat") %>%
"$"(Y2) %>%matrix(., ncol = 3, byrow = T)
other_new02 <- 1/(rowSums(exp(tmp_new02)) + 1)
share_new02 <- sweep(exp(tmp_new02), MARGIN = 1, FUN = "*", STATS = other_new02)
preddat_new02$share[preddat_new02$year == i &
preddat_new02$crop != "wheat"] <-
t(share_new02) %>% as.numeric()
# soybean increase 30%
tmp_new03 <- preddat_new03 %>% filter(year == i, crop != "wheat") %>%
"$"(Y2) %>%matrix(., ncol = 3, byrow = T)
other_new03 <- 1/(rowSums(exp(tmp_new03)) + 1)
share_new03 <- sweep(exp(tmp_new03), MARGIN = 1, FUN = "*", STATS = other_new03)
preddat_new03$share[preddat_new03$year == i &
preddat_new03$crop != "wheat"] <-
t(share_new03) %>% as.numeric()
}
randshare_newsame <- readRDS("/Users/sunhao/Documents/GitHub/ChinaAg/From Hao/report/0506/randshare_newsame.rds")
randshare_new01 <- readRDS("/Users/sunhao/Documents/GitHub/ChinaAg/From Hao/report/0506/randshare_new01.rds")
randshare_new02 <- readRDS("/Users/sunhao/Documents/GitHub/ChinaAg/From Hao/report/0506/randshare_new02.rds")
randshare_new03 <- readRDS("/Users/sunhao/Documents/GitHub/ChinaAg/From Hao/report/0506/randshare_new03.rds")
LB_newsame <- randshare_newsame %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.025))
LB_new01 <- randshare_new01 %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.025))
LB_new02 <- randshare_new02 %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.025))
LB_new03 <- randshare_new03 %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.025))
UB_newsame <- randshare_newsame %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.975))
UB_new01 <- randshare_new01 %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.975))
UB_new02 <- randshare_new02 %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.975))
UB_new03 <- randshare_new03 %>%
apply(., MARGIN = 1, FUN = function(x) quantile(x, prob = 0.975))
rawacre <- readxl::read_xls("/Users/sunhao/Documents/GitHub/ChinaAg/From Hao/rawdata/PlantAcre0409.xls")
colnames(rawacre) <- c("index", "region", "year", "value")
# region
rawacre$region <- factor(rawacre$region, labels = c("Neimenggu", "Jilin", "Shandong", "Hebei",
"Henan", "Liaoning", "Heilongjiang"))
# filter
acredat <- rawacre %>% filter(region != "Henan", index != "耕地面积（千公顷）")
# index
acredat$index <- factor(acredat$index, labels = c("total", "soybean", "wheat", "corn", "rice"))
acredat <- acredat %>% spread(key = index, value = value)
acredat$year <- as.numeric(acredat$year)
acredat$total <- as.numeric(acredat$total)
acredat$soybean <- as.numeric(acredat$soybean)
acredat$wheat <- as.numeric(acredat$wheat)
acredat$corn <- as.numeric(acredat$corn)
acredat$rice <- as.numeric(acredat$rice)
acredat <- acredat %>% dplyr::select(region, year, total) %>%
filter(region %in% c("Neimenggu", "Jilin", "Liaoning", "Heilongjiang"))
preddat_newsame <- preddat_newsame %>%
mutate(region = factor(region, levels = c("Neimenggu", "Jilin", "Liaoning", "Heilongjiang"))) %>%
arrange(region, crop, year)
preddat_new01 <- preddat_new01 %>%
mutate(region = factor(region, levels = c("Neimenggu", "Jilin", "Liaoning", "Heilongjiang"))) %>%
arrange(region, crop, year)
preddat_new02 <- preddat_new02 %>%
mutate(region = factor(region, levels = c("Neimenggu", "Jilin", "Liaoning", "Heilongjiang"))) %>%
arrange(region, crop, year)
preddat_new03 <- preddat_new03 %>%
mutate(region = factor(region, levels = c("Neimenggu", "Jilin", "Liaoning", "Heilongjiang"))) %>%
arrange(region, crop, year)
pred_total <-
acredat %>% filter(year %in% c(2018, 2021)) %>%
spread(key = year, value = total) %>%
mutate(avgchange = (`2021` - `2018`)/3) %>%
mutate(`2022` = `2021` + avgchange,
`2023` = `2021` + avgchange * 2,
`2024` = `2021` + avgchange * 3) %>%
select(`2022`, `2023`, `2024`) %>%
as.matrix() %>% t() %>%
kronecker(rep(1, 4), .) %>% as.vector()
preddat_newsame <- preddat_newsame %>%
mutate(total = pred_total, acre = total * share,
acre_LB = total * LB_newsame, acre_UB = total * UB_newsame)
preddat_new01 <- preddat_new01 %>%
mutate(total = pred_total, acre = total * share,
acre_LB = total * LB_newsame, acre_UB = total * UB_newsame)
preddat_new02 <- preddat_new02 %>%
mutate(total = pred_total, acre = total * share,
acre_LB = total * LB_newsame, acre_UB = total * UB_newsame)
preddat_new03 <- preddat_new03 %>%
mutate(total = pred_total, acre = total * share,
acre_LB = total * LB_newsame, acre_UB = total * UB_newsame)
share_newsame <-
regdat_V2 %>%
select(region, crop, year, share) %>%
rbind(., preddat_newsame %>% select(region, crop, year, share) %>%
mutate(share = share * 100)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, T), c(21, 3)), 12))
share_new01 <-
regdat_V2 %>%
select(region, crop, year, share) %>%
rbind(., preddat_new01 %>% select(region, crop, year, share) %>%
mutate(share = share * 100)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, "T01"), c(21, 3)), 12))
share_new02 <-
regdat_V2 %>%
select(region, crop, year, share) %>%
rbind(., preddat_new02 %>% select(region, crop, year, share) %>%
mutate(share = share * 100)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, "T02"), c(21, 3)), 12))
share_new03 <-
regdat_V2 %>%
select(region, crop, year, share) %>%
rbind(., preddat_new03 %>% select(region, crop, year, share) %>%
mutate(share = share * 100)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, "T03"), c(21, 3)), 12))
acre_newsame <-
regdat_V2 %>% left_join(., acredat) %>% mutate(acre = share * total/100) %>%
select(region, crop, year, acre) %>%
mutate(acre_LB = acre, acre_UB = acre) %>%
rbind(., preddat_newsame %>% select(region, crop, year, acre, acre_LB, acre_UB)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, T), c(21, 3)), 12))
acre_new01 <-
regdat_V2 %>% left_join(., acredat) %>% mutate(acre = share * total/100) %>%
select(region, crop, year, acre) %>%
mutate(acre_LB = acre, acre_UB = acre) %>%
rbind(., preddat_new01 %>% select(region, crop, year, acre, acre_LB, acre_UB)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, "T01"), c(21, 3)), 12))
acre_new02 <-
regdat_V2 %>% left_join(., acredat) %>% mutate(acre = share * total/100) %>%
select(region, crop, year, acre) %>%
mutate(acre_LB = acre, acre_UB = acre) %>%
rbind(., preddat_new02 %>% select(region, crop, year, acre, acre_LB, acre_UB)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, "T02"), c(21, 3)), 12))
acre_new03 <-
regdat_V2 %>% left_join(., acredat) %>% mutate(acre = share * total/100) %>%
select(region, crop, year, acre) %>%
mutate(acre_LB = acre, acre_UB = acre) %>%
rbind(., preddat_new03 %>% select(region, crop, year, acre, acre_LB, acre_UB)) %>%
arrange(region, crop, year) %>%
filter(crop %in% c("corn", "rice", "soybean")) %>%
mutate(pred = rep(rep(c(F, "T03"), c(21, 3)), 12))
corn_g1 <- ggplot() +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("corn_FALSE" = "black",
"corn_TRUE" = "#6AB8EE",
"corn_T01" = "#5FEC49",
"corn_T02" = "#E69A1F",
"corn_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Share (%)") +
ggtitle("Province Level Corn Share Prediction in Northeast China") +
theme(plot.title = element_text(hjust = 0.5), legend.position='none') +
theme_bw()
corn_g2 <- ggplot() +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new03 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new03 %>% filter(crop == "corn", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("corn_FALSE" = "black",
"corn_TRUE" = "#6AB8EE",
"corn_T01" = "#5FEC49",
"corn_T02" = "#E69A1F",
"corn_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Acreage (unit = 10 km2)") +
ggtitle("Province Level Corn Acreage Prediction in Northeast China") +
theme(plot.title = element_text(hjust = 0.5)) +
theme_bw()
ggpubr::ggarrange(corn_g1, corn_g2, ncol = 2)
corn_g1 <- ggplot() +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("corn_FALSE" = "black",
"corn_TRUE" = "#6AB8EE",
"corn_T01" = "#5FEC49",
"corn_T02" = "#E69A1F",
"corn_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Share (%)") +
ggtitle("Province Level Corn Share Prediction in Northeast China") +
theme(plot.title = element_text(hjust = 0.5), legend.position='none') +
theme_bw()
corn_g1
?scale_color_manual
corn_g1 <- ggplot() +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("corn_FALSE" = "black",
"corn_TRUE" = "#6AB8EE",
"corn_T01" = "#5FEC49",
"corn_T02" = "#E69A1F",
"corn_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Share (%)") +
ggtitle("Province Level Corn Share Prediction in Northeast China") +
theme_bw()+ theme(plot.title = element_text(hjust = 0.5), legend.position='none')
corn_g1
corn_g1 <- ggplot() +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new03 %>% filter(crop == "corn", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("corn_FALSE" = "black",
"corn_TRUE" = "#6AB8EE",
"corn_T01" = "#5FEC49",
"corn_T02" = "#E69A1F",
"corn_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Share (%)") +
ggtitle("Province Level Corn Share Prediction in Northeast China") +
theme_bw() + theme(plot.title = element_text(hjust = 0.5), legend.position='none')
corn_g2 <- ggplot() +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new03 %>% filter(crop == "corn", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_newsame %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new01 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new02 %>% filter(crop == "corn", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new03 %>% filter(crop == "corn", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("corn_FALSE" = "black",
"corn_TRUE" = "#6AB8EE",
"corn_T01" = "#5FEC49",
"corn_T02" = "#E69A1F",
"corn_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Acreage (unit = 10 km2)") +
ggtitle("Province Level Corn Acreage Prediction in Northeast China") +
theme(plot.title = element_text(hjust = 0.5)) +
theme_bw()
ggpubr::ggarrange(corn_g1, corn_g2, ncol = 2)
ggpubr::ggarrange(corn_g1, corn_g2, ncol = 2)
ggpubr::ggarrange(corn_g1, corn_g2, ncol = 2, widths = c(3, 7))
ggpubr::ggarrange(corn_g1, corn_g2, ncol = 2, widths = c(3, 7))
ggpubr::ggarrange(corn_g1, corn_g2, ncol = 2, widths = c(4, 6))
soybean_g1 <- ggplot() +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new01 %>% filter(crop == "soybean", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new02 %>% filter(crop == "soybean", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_new03 %>% filter(crop == "soybean", year >= 2015)) +
geom_point(aes(x = year, y = share, color = interaction(crop, pred, sep = "_")),
data = share_newsame %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_newsame %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new01 %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new02 %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = share),
data = share_new03 %>% filter(crop == "soybean", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("soybean_FALSE" = "black",
"soybean_TRUE" = "#6AB8EE",
"soybean_T01" = "#5FEC49",
"soybean_T02" = "#E69A1F",
"soybean_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Share (%)") +
ggtitle("Province Level Soybean Share Prediction in Northeast China") +
theme_bw() + theme(plot.title = element_text(hjust = 0.5), legend.position='none')
soybean_g2 <- ggplot() +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new01 %>% filter(crop == "soybean", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new02 %>% filter(crop == "soybean", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_new03 %>% filter(crop == "soybean", year >= 2015)) +
geom_point(aes(x = year, y = acre, color = interaction(crop, pred, sep = "_")),
data = acre_newsame %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_newsame %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new01 %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new02 %>% filter(crop == "soybean", year >= 2015)) +
geom_line(aes(x = year, y = acre),
data = acre_new03 %>% filter(crop == "soybean", year >= 2015)) +
facet_wrap(~region, nrow = 2, scales = "free") +
scale_x_continuous(breaks = seq(2015, 2024, 2)) +
scale_color_manual(name = "",
values = c("soybean_FALSE" = "black",
"soybean_TRUE" = "#6AB8EE",
"soybean_T01" = "#5FEC49",
"soybean_T02" = "#E69A1F",
"soybean_T03" = "#E6471F"),
labels = c("Observed", "Same subsidy as 2021",
"Subsidy Increase 10%", "Subsidy Increase 20%",
"Subsidy Increase 30%")) +
xlab("Year") + ylab("Acreage (unit = 10 km2)") +
ggtitle("Province Level Soybean Acreage Prediction in Northeast China") +
theme(plot.title = element_text(hjust = 0.5)) +
theme_bw()
ggpubr::ggarrange(soybean_g1, soybean_g2, ncol = 2, widths = c(4, 6))
ggpubr::ggarrange(soybean_g1, soybean_g2, ncol = 2, widths = c(4, 6))
ggpubr::ggarrange(soybean_g1, soybean_g2, ncol = 2, widths = c(4, 6))
